<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuestra Historia üíô</title>
    <meta name="theme-color" content="#0f2a38">
    <link rel="stylesheet" href="styles/styles-index.css
    ">
</head>
<body>
    <!-- Navegaci√≥n Simple -->
    <nav class="navbar-simple">
        <div class="nav-content">
            <a href="index.html" class="logo-simple">üíô Nuestra Historia</a>
            <button class="nav-toggle" aria-label="Abrir men√∫" aria-expanded="false" aria-controls="menu-simple">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu-simple" id="menu-simple">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="poemas/poemas.html">Poemas</a></li>
                <li><a href="canciones/canciones.html">Canciones</a></li>
                <li><a href="galeria/galeria.html">Galer√≠a</a></li>
                <li><a href="mensajes/mensajes.html">Mensajes</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section - Rom√°ntico -->
    <section class="hero-nuevo">
        <div class="hero-bg"></div>
        <div class="hero-content-nuevo">
            <div class="hearts-animation">
                <span class="heart">‚ù§Ô∏è</span>
                <span class="heart">ü§ç</span>
                <span class="heart">‚ù§Ô∏è</span>
                <span class="heart">ü§ç</span>
                <span class="heart">‚ù§Ô∏è</span>
            </div>
            
            <h1 class="main-title">Nuestra Historia</h1>
            <p class="subtitle">Cada d√≠a contigo es un regalo üíù</p>
            
            <div class="days-counter">
                <div class="counter-box">
                    <span class="days-number" id="diasCounter">191</span>
                    <span class="days-label">D√≠as Juntos</span>
                </div>
                <div class="couple-info">
                    <p class="since-date" id="sinceDate">Desde el 05/06/2025</p>
                    <p class="message">Te amo m√°s cada d√≠a ‚ú®</p>
                </div>
            </div>

            
        </div>
    </section>

    <!-- Secci√≥n Poemas -->
    <section class="section-wrapper" id="poemas">
        <div class="section-inner">
            <h2 class="section-title">üìù Poemas</h2>
            <p class="section-desc">Las palabras que guard√≥ mi coraz√≥n para ti</p>
            <div class="items-preview" id="poemasPreview">
                <p class="no-items">A√∫n no hay poemas... pero aqu√≠ escribir√© nuestras historias üåπ</p>
            </div>
            <div class="section-footer">
                <a href="poemas/poemas.html" class="btn-primary">Ver Todos los Poemas</a>
            </div>
        </div>
    </section>

    <!-- Secci√≥n Canciones -->
    <section class="section-wrapper alt" id="canciones">
        <div class="section-inner">
            <h2 class="section-title">üéµ Canciones</h2>
            <p class="section-desc">La m√∫sica que define nuestro amor</p>
            <div class="items-preview" id="cancionesPreview">
                <p class="no-items">Nuestras canciones favoritas estar√°n aqu√≠ üé∂</p>
            </div>
            <div class="section-footer">
                <a href="canciones/canciones.html" class="btn-primary">Ver Todas las Canciones</a>
            </div>
        </div>
    </section>

    <!-- Secci√≥n Galer√≠a -->
    <section class="section-wrapper" id="galeria">
        <div class="section-inner">
            <h2 class="section-title">üì∏ Galer√≠a</h2>
            <p class="section-desc">Nuestros momentos capturados en el tiempo</p>
            <div class="gallery-preview" id="galeriaPreview">
                <p class="no-items">Aqu√≠ estar√°n nuestros recuerdos m√°s especiales üì∑</p>
            </div>
            <div class="section-footer">
                <a href="galeria/galeria.html" class="btn-primary">Ver Galer√≠a Completa</a>
            </div>
        </div>
    </section>

    <!-- Secci√≥n Mensajes -->
    <section class="section-wrapper alt" id="mensajes">
        <div class="section-inner">
            <h2 class="section-title">üíå Mensajes</h2>
            <p class="section-desc">Lo que mi coraz√≥n necesita decirte</p>
            <div class="items-preview" id="mensajesPreview">
                <p class="no-items">Mis mensajes de amor esperan por ti aqu√≠ üíï</p>
            </div>
            <div class="section-footer">
                <a href="mensajes/mensajes.html" class="btn-primary">Ver Todos los Mensajes</a>
            </div>
        </div>
    </section>

    <!-- Secci√≥n Meses -->
    <section class="section-wrapper" id="meses">
        <div class="section-inner">
            <h2 class="section-title">üéâ Celebraciones Mensuales</h2>
            <p class="section-desc">Cada mes es un nuevo aniversario que celebrar contigo</p>
            <div class="meses-preview" id="mesesPreview">
                <p class="no-items">Nuestras celebraciones mensuales ir√°n aqu√≠ üéä</p>
            </div>
            <div class="section-footer">
                <a href="meses/meses.html" class="btn-primary">Ver Todos los Meses</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer-nuevo">
        <p>Hecho con üíô para la persona que amo</p>
        <p class="footer-date" id="footerSince">Nuestra historia comenz√≥ el 05/06/2025 y sigue escribi√©ndose cada d√≠a</p>
    </footer>

    <script>
        // Configuraci√≥n de fechas
        const FECHA_INICIO = new Date(2025, 4, 6); // mayo = 4 (0-indexed), d√≠a 6

        // Calcular d√≠as juntos y actualizar textos relacionados
        function calcularDiasJuntos() {
            const hoy = new Date();
            const diferencia = hoy - FECHA_INICIO;
            const dias = Math.floor(diferencia / (1000 * 60 * 60 * 24));
            const diasEl = document.getElementById('diasCounter');
            if (diasEl) diasEl.textContent = dias;

            const meses = ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'];
            const dia = FECHA_INICIO.getDate();
            const mes = meses[FECHA_INICIO.getMonth()];
            const anio = FECHA_INICIO.getFullYear();
            
            const fechaFormato = `${dia} de ${mes} de ${anio}`;
            
            const sinceEl = document.getElementById('sinceDate');
            if (sinceEl) sinceEl.textContent = `Desde el ${fechaFormato}`;
            const footerSince = document.getElementById('footerSince');
            if (footerSince) footerSince.textContent = `Nuestra historia comenz√≥ el ${fechaFormato} y sigue escribi√©ndose cada d√≠a`;
        }

        // Cargar previews de todas las secciones
        async function cargarPreviews() {
            await cargarPreviewPoemas();
            cargarPreviewCanciones();
            cargarPreviewGaleria();
            cargarPreviewMensajes();
            cargarPreviewMeses();
        }

        // Poemas
        async function cargarPreviewPoemas() {
            const container = document.getElementById('poemasPreview');
            
            try {
                const response = await fetch('http://localhost:3000/api/poemas/get');
                const data = await response.json();
                
                if (!data.success || !data.poemas || data.poemas.length === 0) {
                    container.innerHTML = '<p class="no-items">A√∫n no hay poemas... pero aqu√≠ escribir√© nuestras historias üåπ</p>';
                    return;
                }
                
                container.innerHTML = data.poemas.slice(0, 3).map(poema => `
                    <div class="item-card">
                        <h3>${poema.titulo}</h3>
                        <p>${poema.contenido.substring(0, 100)}...</p>
                        <div class="meta">Por: ${poema.autor}</div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('‚ùå Error cargando poemas del preview:', error);
                container.innerHTML = '<p class="no-items">A√∫n no hay poemas... pero aqu√≠ escribir√© nuestras historias üåπ</p>';
            }
        }

        // Canciones
        async function cargarPreviewCanciones() {
            const container = document.getElementById('cancionesPreview');
            
            try {
                const response = await fetch('http://localhost:3000/api/canciones/get');
                const data = await response.json();
                
                if (!data.success || !data.canciones || data.canciones.length === 0) {
                    container.innerHTML = '<p class="no-items">Nuestras canciones favoritas estar√°n aqu√≠ üé∂</p>';
                    return;
                }
                
                container.innerHTML = data.canciones.slice(0, 3).map(cancion => `
                    <div class="item-card">
                        <h3>üéµ ${cancion.titulo}</h3>
                        <p><strong>${cancion.artista}</strong></p>
                        <p>${cancion.razon}</p>
                    </div>
                `).join('');
            } catch (error) {
                console.error('‚ùå Error cargando canciones del preview:', error);
                container.innerHTML = '<p class="no-items">Nuestras canciones favoritas estar√°n aqu√≠ üé∂</p>';
            }
        }

        // Mensajes
        function cargarPreviewMensajes() {
            const mensajes = JSON.parse(localStorage.getItem('mensajes_app') || '[]');
            const container = document.getElementById('mensajesPreview');
            
            if (mensajes.length === 0) {
                container.innerHTML = '<p class="no-items">Mis mensajes de amor esperan por ti aqu√≠ üíï</p>';
                return;
            }
            
            container.innerHTML = mensajes.slice(0, 3).map(mensaje => `
                <div class="item-card">
                    <h3>${mensaje.asunto}</h3>
                    <p>${mensaje.contenido.substring(0, 100)}...</p>
                </div>
            `).join('');
        }

        // Galer√≠a
        function cargarPreviewGaleria() {
            const fotos = JSON.parse(localStorage.getItem('fotos_app') || '[]');
            const container = document.getElementById('galeriaPreview');
            
            if (fotos.length === 0) {
                container.innerHTML = '<p class="no-items">Aqu√≠ estar√°n nuestros recuerdos m√°s especiales üì∑</p>';
                return;
            }
            
            const galeriaHTML = fotos.slice(0, 3).map(foto => `
                <div class="gallery-item">
                    <img src="${foto.url}" alt="${foto.caption || 'Foto'}">
                </div>
            `).join('');
            
            container.innerHTML = galeriaHTML;
        }

        // Meses
        function cargarPreviewMeses() {
            const meses = JSON.parse(localStorage.getItem('meses_app') || '[]');
            const container = document.getElementById('mesesPreview');
            
            if (meses.length === 0) {
                container.innerHTML = '<p class="no-items">Nuestras celebraciones mensuales ir√°n aqu√≠ üéä</p>';
                return;
            }
            
            container.innerHTML = meses.slice(0, 3).map(mes => `
                <div class="mes-card">
                    <div class="mes-number">${mes.numero}</div>
                    <p><strong>Mes ${mes.numero}</strong></p>
                    <p>${mes.fecha}</p>
                    <p style="margin-top: 0.8rem; font-size: 0.95rem; color: var(--coral);">${mes.mensaje}</p>
                </div>
            `).join('');
        }

        // Smooth scroll para los links del navbar
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (href !== '#') {
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            });
        });

        // Toggle men√∫ m√≥vil
        const navToggle = document.querySelector('.nav-toggle');
        const navMenu = document.getElementById('menu-simple');
        if (navToggle && navMenu) {
            navToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                const abierto = navMenu.classList.toggle('open');
                navToggle.setAttribute('aria-expanded', abierto ? 'true' : 'false');
            });
            
            // Cerrar men√∫ cuando se hace click en un link
            navMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    navMenu.classList.remove('open');
                    navToggle.setAttribute('aria-expanded', 'false');
                });
            });
            
            // Cerrar men√∫ cuando se hace click fuera
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.navbar-simple')) {
                    navMenu.classList.remove('open');
                    navToggle.setAttribute('aria-expanded', 'false');
                }
            });
        }

        // Animaciones al hacer scroll
        const observar = () => {
            const obs = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('fade-in');
                        obs.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.12 });
            document.querySelectorAll('.item-card, .mes-card, .gallery-item, .section-title').forEach(el => obs.observe(el));
        };

        // Inicializar
        calcularDiasJuntos();
        cargarPreviews();
        observar();

        // Recargar previews cada segundo (por si hay cambios desde otra pesta√±a)
        setInterval(cargarPreviews, 2000);
    </script>
</body>
</html>
